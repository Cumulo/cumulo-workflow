
[
[ "ns" "tiye-server.view" [ ":require" [ "[]" "tiye-server.schema" ":as" "schema" ] ] ]
[ "defn" "render-scene" [ "db" ] "db" ]
[ "defn" "render-view" [ "state-id" "db" ] [ "{}" [ ":state" [ "get-in" "db" [ "[]" ":states" "state-id" ] ] ] [ ":messages" [ ":messages" "db" ] ] [ ":buffers" [ "->>" [ ":states" "db" ] [ "filter" [ "fn" [ "entry" ] [ "some?" [ ":buffer" [ "last" "entry" ] ] ] ] ] [ "map" [ "fn" [ "entry" ] [ "let" [ [ "state" [ "last" "entry" ] ] ] [ "[]" [ ":id" "state" ] [ "merge" "schema/message" [ "{}" [ ":id" [ ":id" "state" ] ] [ ":text" [ ":buffer" "state" ] ] [ ":time" [ ":buffer-time" "state" ] ] [ ":nickname" [ ":nickname" "state" ] ] [ ":writing?" "true" ] ] ] ] ] ] ] [ "into" [ "{}" ] ] ] ] [ ":statistics" [ "{}" [ ":user-count" [ "count" [ ":states" "db" ] ] ] ] ] ] ]
]
